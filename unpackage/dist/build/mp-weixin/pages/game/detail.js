(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/game/detail"],{"0ec5":function(e,t,a){"use strict";a.r(t);var n=a("af70"),i=a("4e47");for(var r in i)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(r);a("114a");var o=a("f0c5"),s=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"25fc17ca",null,!1,n["a"],void 0);t["default"]=s.exports},"114a":function(e,t,a){"use strict";var n=a("d4d0"),i=a.n(n);i.a},"34ed":function(e,t,a){"use strict";(function(e,t){var n=a("4ea4");a("6c5a");n(a("66fd"));var i=n(a("0ec5"));e.__webpack_require_UNI_MP_PLUGIN__=a,t(i.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])},"4e47":function(e,t,a){"use strict";a.r(t);var n=a("8f1a"),i=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},"8f1a":function(e,t,a){"use strict";(function(e,n){var i=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a("2eee")),o=i(a("c973")),s={data:function(){return{p:{},taoNumber:1,disabled:!1,id:"",goods:a("c414"),code:"",getUserInfo:{},getUserInfoDataToken:!1,qty:1,deviceId:"",serviceId:"",unids:"",characteristicIdthis:""}},onLoad:function(t){if(t.param){var a=JSON.parse(t.param);this.deviceId=a.deviceId,this.serviceId=a.serviceId,this.unids=a.unids,this.characteristicId=a.characteristicId,console.log("====蓝牙传到商品页参数====>>>>>",a)}var n=e.getStorageSync("usersInfo");n&&(this.getUserInfo=JSON.parse(n),this.getUserInfo.data&&this.getUserInfo.data.userinfo&&(this.getUserInfoDataToken=!!this.getUserInfo.data.userinfo))},methods:{toPay:function(){1==this.taoNumber?this.qty=1:this.qty=2,this.createorder()},loginfn:function(){var e=this;n.login({success:function(t){e.code=t.code}})},onGetPhoneNumber:function(e){var t=this;return(0,o.default)(r.default.mark((function a(){var n,i,o,s;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=t,"getPhoneNumber:ok"===e.detail.errMsg&&(i=e.detail,o=i.iv,s=i.encryptedData,n.getawardDetail(n.code,s,o));case 2:case"end":return a.stop()}}),a)})))()},redu:function(){this.taoNumber<=1?this.taoNumber=1:this.taoNumber--},add:function(){this.taoNumber>=2?this.taoNumber=2:this.taoNumber++},createorder:function(){var t=this;return(0,o.default)(r.default.mark((function a(){var n;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=t,e.request({url:"http://ys.shningmi.com/api/order/create",data:{guid:"guid",qty:t.qty},header:{"Content-Type":"application/json",token:t.getUserInfo.data.token},method:"POST",success:function(t){console.log("微1122221信支付参数------",t.data.data.noncestr),console.log("微1333122221信支付参数------",t.data.data.signtype),e.requestPayment({provider:"wxpay",timeStamp:t.data.data.timeStamp,nonceStr:t.data.data.nonceStr,package:t.data.data.package,signType:t.data.data.signType,paySign:t.data.data.sign,success:function(e){console.log("支付成功",e),n.writeBLECharacteristicValue()},fail:function(e){console.log("支付失败",e)}})}});case 2:case"end":return a.stop()}}),a)})))()},writeBLECharacteristicValue:function(){var t=1==this.qty?"PBSS":"PASS";console.log("====蓝牙写入参数qtyString====>>>>>",t),console.log("====蓝牙写入参数unids====>>>>>",this.unids),console.log("====蓝牙写入参数deviceId====>>>>>",this.deviceId),console.log("====蓝牙写入参数characteristicId====>>>>>",this.characteristicId);for(var a=t+this.unids,n=new ArrayBuffer(a.length),i=new DataView(n),r=0;r<a.length;r++)i.setUint8(r,a.charAt(r).charCodeAt());var o=this.ab2hex(n)+"0D0A",s=new Uint8Array(o.match(/[\da-f]{2}/gi).map((function(e){return parseInt(e,16)}))).buffer;e.writeBLECharacteristicValue({deviceId:this.deviceId,serviceId:this.serviceId,characteristicId:this.characteristicId,value:s,success:function(t){console.log("写入成功",t),e.showToast({icon:"none",title:"开启成功"})},fail:function(e){console.log("写入失败1",JSON.stringify(e))}})},ab2hex:function(e){var t=Array.prototype.map.call(new Uint8Array(e),(function(e){return e.toString(16).slice(-2)}));return t.join("")},getawardDetail:function(t,a,n){var i=this;e.request({url:"http://ys.shningmi.com/api/login/login",data:{code:t,encryptedData:a,iv:n},header:{"Content-Type":"application/json"},method:"POST",success:function(t){var a=t.data;e.setStorageSync("usersInfo",JSON.stringify(a)),i.getUserInfo=JSON.parse(e.getStorageSync("usersInfo")),console.log("缓存数据------",i.getUserInfo.data),i.getUserInfo.data&&i.getUserInfo.data.userinfo&&(console.log("缓存数据------",i.getUserInfo.data.userinfo),i.getUserInfoDataToken=!!i.getUserInfo.data.userinfo)}})}}};t.default=s}).call(this,a("543d")["default"],a("bc2e")["default"])},af70:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){}));var n=function(){var e=this.$createElement;this._self._c},i=[]},d4d0:function(e,t,a){}},[["34ed","common/runtime","common/vendor"]]]);