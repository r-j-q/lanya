{"version":3,"sources":["uni-app:///main.js","webpack:///E:/y/lanya/pages/index/index.vue?a742","webpack:///E:/y/lanya/pages/index/index.vue?b023","webpack:///E:/y/lanya/pages/index/index.vue?f77a","webpack:///E:/y/lanya/pages/index/index.vue?487a","uni-app:///pages/index/index.vue","webpack:///E:/y/lanya/pages/index/index.vue?5304","webpack:///E:/y/lanya/pages/index/index.vue?9ca5"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","data","addressInfo","showButton","duration","list","deviceId","serviceId","characteristics","characteristicId","lanya","getLocation","getUserInfo","getUserInfoDataToken","code","address","latitude","longitude","address_component","timer","openLanYa","onLoad","onShow","methods","openAuthSetting","uni","success","console","title","content","icon","that","complete","handleLanya","key","type","fail","qqmapsdk","location","result","city","loginfn","onGetPhoneNumber","val","iv","encryptedData","getawardDetail","url","header","method","res","userinfo","handleOpenBluetoothAdapter","clearInterval","startBluetoothDeviceDiscovery","onBluetoothDeviceFound","name","getBluetoothDevices","createBLEConnection","_this","stopBluetoothDevicesDiscovery","getBLEDeviceCharacteristics","setTimeout","item","notifyBLECharacteristicValueChange","state","getBLEDeviceServices","uuid","strToHexCharCode","hexCharCode","handleInToPay","unids","writeBLECharacteristicValue","msg","buffer","dataView","resHex","buffers","value","string2buffer","str2ab","x","ab2hex","hexCharCodeToStr","trimedStr","alert","curCharCode","resultStr","listenValueChange","openBluetoothAdapterPay","createorder","guid","qty","provider","timeStamp","nonceStr","package","signType","paySign","v"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACqC;;;AAGzF;AACmK;AACnK,gBAAgB,6KAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAkmB,CAAgB,+mBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACyDtnB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AADA;;AAEA;AAAA,eACA;EACAC;IACA;EAAA,CACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IAEA;EACA;EAEAC;IAAA;IAEA;MACA;QACA;MAEA;IACA;IAEA;IACA;MACA;MACA;QACA;MACA;IACA;EACA;EACAC;IAGA;IACAC;MAAA;MACA;MACAC;QACAC;UACAC;UACA,0EACA;YACAF;cACAG;cACAC;cACAH;gBACA;kBACAD;oBACAG;oBACAE;kBACA;gBACA;kBACAL;oBACAC;sBACAC;sBACA,uBACA;wBACAF;0BACAG;0BACAE;wBACA;wBACA;wBACAC;sBACA;wBACAN;0BACAG;0BACAE;wBACA;sBACA;oBACA;kBACA;gBACA;cACA;YACA;UACA;YACA;YACA;UACA;YACA;YACA;UACA;QACA;QACAE;UACAL;QACA;MACA;IACA;IACA;IACAM;MACA;MAGA;MACA;QACAC;MACA;;MACAvC;QACAwC;QACAT;UACAC;UACAI;UACAA;UAGApC;UACAA;QACA;QACAyC;UACAX;YACAG;YACAE;UACA;UACAC;QACA;QACAC;UACA;UACAK;YACAC;cACAtB;cACAC;YACA;YACAS;cACAK;cACAA,oCACAb;cACAS;cACAI;cACApC,2CACA4C,yBACAC;YACA;YACAJ;cACAT;YACA;UACA;QACA;MACA;IACA;IAEA;IACA;IACAc;MACA;MACA9C;QACA+B;UACAK;UACA;QAEA;MACA;IACA;IACA;IACAW;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBACAX;gBACA;kBAEA;kBAAA,cAIAY,YAFAC,qBACAC;gBAKA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAf;gBAAA;gBAAA,OACAN;kBACAsB;kBACA9C;oBAAA;oBACAa;kBAEA;kBACAkC;oBACA;oBACA;kBACA;;kBACAC;kBAAA;kBACAvB;oBAGA,IACAzB,OACAiD,IADAjD;oBAGAwB,+CACAxB;oBACA,mDACA;oBACA0B,mDACAwB;oBACA,uDACAA;sBAEAxB,8CACA1B;sBACA,iDACAA;oBACA;kBAIA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACA;IAIA;IACAmD;MAAA;MACA;QACA3B;UACAG;QACA;QACAD;QACA;MACA;QACAA;QACA;QACA0B;QACA5B;MACA;MAGAA;QACAC;UAAA;UACAD;YAAA;YACAC;cACA;cACA2B;cACA1B;cACAF;cACA;cACA;YACA;YACAW;cACAX;gBACAK;gBACA1B,eACAA;gBACAwB;cACA;YACA;UACA;QAEA;QACAQ;UACA;UACA;UACA;UACA;UACA;QAAA;MAEA;IACA;IACA;IACAkB;MAAA;MACA7B;QACAC;UACAC,YACA,0CACAuB;UACA;UACA;QACA;QACAd;UACAT;QACA;MACA;IACA;IACA;IACA4B;MAAA;MACA9B;QAEA;UACA;YACA;YACA;cACA+B;cACAlD;YACA;YACA;UACA;QAEA;MACA;IACA;IACA;IACAmD;MACA9B;MACAF;QACAC;UACAC;UACAA;QACA;MACA;IACA;IACA;IACA+B;MACA;MACA;MACA;MACA;MACAjC;QACA;QACAnB;QACAoB;UACAC;UACA;UACAgC;QACA;QACAvB;UACAT;QACA;MACA;IACA;IACA;IACAiC;MAAA;MACAnC;QACAC;UACA;UACAC;QACA;QACAS;UACAT;QACA;MACA;IACA;IAEA;IACAkC;MAAA;MACA;MACAlC;MACAmC;QACArC;UACA;UACAnB;UACA;UACAC;UACAmB;YACAC,YACA,iCACAuB;YACA,8BACA1C;YACAmB,4BACAnB;YACA;YACA0C;cACA,sBACA;gBACAS,MACAlD,mBACAsD;gBACA;gBACA;gBACAJ,MACAK,mCACAD;cACA;YACA;UACA;UACA3B;YACAT;UACA;QACA;MACA;IACA;IACA;IACAqC;MACA;MACArC;MACAF;QACAwC;QAAA;QACA;QACA3D;QACA;QACAC;QACA;QACAE;QACAiB;UACAC;UACA;UACAgC;UACAhC,YACA,8CACAuB;QACA;QACAd;UACAT,YACA,2CACAuB;QACA;MACA;IACA;IACA;IACAgB;MAAA;MACAJ;QACArC;UACA;UACAnB;UACAoB;YACAC;YACA;YACA;YACA;YACAuB;cACA,sBACA;gBACA,yBACAiB;gBACAxC,uBACA;gBACA;gBACA;cACA;YACA;UACA;QACA;MACA;IACA;IACAyC;MACA,gBACA;MACA;MACAC;MACA;QACAA;MACA;MACA;IACA;IACAC;MACA;QACAhE;QACAC;QACAgE;QACA9D;MACA;MACA;MACAgB;QACAsB;MACA;IACA;IACA;IACAyB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA7C;gBACAA;gBACAA;gBACAA;gBACA4C,uCACA;gBACAE;gBACAC;gBACAC;gBACA;kBACAA;gBACA;gBACAC;gBAGAC,0DACA;kBACA;gBACA;gBACAlD;gBACAF;kBACAnB;kBACAC;kBACAE;kBACAqE;kBACApD;oBACAC;oBACAF;sBACAK;sBACAF;oBACA;kBACA;kBACAQ;oBACAT;oBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAGA;IAEA;IAEAoD;MAEA;;MAEA;MAEA;QAEA;UAEApC;QAEA;UAEAA;QAEA;MAEA;MACAhB;MACA;;MAEA;;MAEA;QAEA;MAEA;IAIA;IACAqD;MACA;MACA;MACA;QACAC;MACA;MACA;IACA;IACA;IACAC;MACA,sCACA,wBACA;QACA;MACA,EACA;MACA;IACA;IAEA;IACAC;MACA;MACA,6DACAC;MACA;MACA;QACAC;QACA;MACA;MACA;MACA;MACA;QACAC;QACAC;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA7D;MACAgC;MACAlC;QACA;QACAE;;QAEA;QACA;QACAA;;QAEA;QACA;QACAA;MACA;IACA;IACA;IACA8D;MACA;MACAhE;QACAC;UACA;UACAK;UACAJ;QACA;QACAS;UAEAL;UACAN;YACAG;YACAC;UACA;UAEA;YACA;YACA;;YAEAF;YACA;;YAGA;YACA;YACA;;YAEA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;UACA;QACA;MACA;IACA;IACA;IACA+D;MACA;MACA;;MAEA;MACAjE;QACAsB;QACA9C;UACA0F;UACAC;UACA7E;UACAC;UACAC;QACA;QACA+B;UACA;UACA;QACA;QACAC;QACAvB;UACA;UACAD;YACAoE;YAAA;YACAC,yBACAA;YAAA;YACAC,wBACAA;YAAA;YACAC;YACAC,wBACAA;YAAA;YACAC;YAAA;YACAxE;cACAC;cACAgC,MACAa,4BACA2B;YAGA;YACA/D;cACAT;YACA;UACA;QAGA;MACA;IAEA,EACA;IAEA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC1vBA;AAAA;AAAA;AAAA;AAA64B,CAAgB,43BAAG,EAAC,C;;;;;;;;;;;ACAj6B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/index/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=57280228&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=57280228&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"57280228\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/index.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=57280228&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"backgroundColorLine\">\r\n\t\t<view class=\"getLocation\" @click=\"handleLanya\">\r\n\t\t\t<image :src=\"getLocation\" class=\"getLocation-\"></image>\r\n\t\t\t{{address_component.street_number ||\"定位失败，点击重新定位\"}}\r\n\t\t</view>  \n\t\t <!-- <nearby></nearby> -->\r\n\t\t<image :src=\"lanya\" class=\"lanyastyle\"></image>\r\n\t\t<!-- <button type=\"primary\" @click=\"startBluetoothDeviceDiscovery\">搜索蓝牙</button>\r\n\t\t<button type=\"primary\" @click=\"onBluetoothDeviceFound\">发现外围设备</button>\r\n\t\t<button type=\"primary\" @click=\"getBluetoothDevices\">获取蓝牙设备信息</button>\r\n\t\t<button type=\"primary\" @click=\"getBLEDeviceServices\">获取蓝牙所有服务</button>\r\n\t\t<button type=\"primary\" @click=\"getBLEDeviceCharacteristics\">进入特征</button> -->\r\n\r\n\r\n\t\t<view class=\"backgroundColorLineText\" v-if=\"!showButton\">\r\n\t\t\t蓝牙连接中,请稍等\r\n\t\t</view>\r\n\r\n\t\t<view class=\"backgroundColorLineSuccess\" v-if=\"showButton\">\r\n\t\t\t{{ list[0].name}} 连接成功\r\n\r\n\t\t</view>\r\n\r\n\r\n\t\t<!-- <view class=\"writeStyle\" v-if=\"showButton\">\r\n\t\t\t<button type=\"primary\" class=\"writeStyle12\"  @click=\"handleOpenBluetoothAdapter\">重试</button>\r\n\t\t\t<button type=\"primary\"  class=\"writeStyle12\" @click=\"handleInToPay\">支付费用</button>\r\n\t\t</view> -->\r\n\t\t<!-- v-if=\"showButton\" -->\n\t\t \r\n\t\t<view class=\"writeStyle\" v-if=\"showButton\">\r\n\r\n\t\t\t<!-- \t<button v-else open-type=\"getPhoneNumber\" v-if=\"!getUserInfoDataToken\" class=\"chexiao\" @click.stop=\"loginfn\"\r\n\t\t\t\t@getphonenumber.stop=\"onGetPhoneNumber\"> 手机号授权</button> -->\r\n\t\t\t<button type=\"primary\" class=\"writeStyle12\" @click=\"openBluetoothAdapterPay\">开 盒</button>\r\n\t\t\t<!-- <button type=\"primary\" class=\"writeStyle12\" @click=\"createorder('PASS',2)\">开二盒</button> -->\r\n\t\t\t<button type=\"primary\" class=\"writeStyle12\" @click=\"writeBLECharacteristicValue('PCSS')\">激 活 机 身</button>\r\n\t\t</view>\r\n\r\n\r\n\r\n\r\n\r\n\t\t<!-- \t<view class=\"writeStyle\">\r\n\t\t\t<button type=\"primary\" class=\"bgColor\" @click=\"handleOpenBluetoothAdapter\">重试</button>\r\n\t\t\t<button type=\"primary\" @click=\"createBLEConnection(item.deviceId)\">连接</button>\r\n\t\t\t<button type=\"primary\" @click=\"stopBluetoothDevicesDiscovery\">停止搜索蓝牙</button>\r\n\t\t</view> -->\r\n\t\t<!-- <view class=\"huanxing\" @click=\"writeBLECharacteristicValue('PCSS')\">激活机身</view> -->\r\n\t\t<!-- <view class=\"huanxing\" @click=\"writeBLECharacteristicValue('PCSS')\">激活机身</view> -->\r\n\t</view>\r\n</template>\r\n\r\n<script>\n\t \n// import nearby from '@/components/pretty-nearby/pretty-nearby.vue'\r\n\timport QQMapWX from '../../utils/qqmap-wx-jssdk.js'\r\n\tvar qqmapsdk;\r\n\texport default {  \n\t\tcomponents:{\n            // nearby\n        },\r\n\t\tdata() {\r\n\t\t\treturn {\n\t\t\t\taddressInfo:{},\r\n\t\t\t\tshowButton: false,\r\n\t\t\t\tduration: 5000,\r\n\t\t\t\tlist: [],\r\n\t\t\t\tdeviceId: '',\r\n\t\t\t\tserviceId: '',\r\n\t\t\t\tcharacteristics: [],\r\n\t\t\t\tcharacteristicId: '',\r\n\t\t\t\tlanya: require('../../static/img/lanya.jpg'),\r\n\t\t\t\tgetLocation: require('../../static/img/getLocation.png'),\r\n\r\n\t\t\t\tgetUserInfo: {},\r\n\t\t\t\tgetUserInfoDataToken: false,\r\n\t\t\t\tcode: \"\",\r\n\r\n\t\t\t\taddress: \"\",\r\n\t\t\t\tlatitude: \"\",\r\n\t\t\t\tlongitude: \"\",\r\n\t\t\t\taddress_component: {},\r\n\t\t\t\ttimer: null,\r\n\t\t\t\topenLanYa: true //判断蓝牙是否开启\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\n\t\t \r\n\t\t\tthis.handleLanya() \r\n\t\t},\r\n\r\n\t\tonShow() {\n\t\t\t \r\n\t\t\tif (this.openLanYa) {\r\n\t\t\t\tthis.timer = setInterval(() => {\r\n\t\t\t\t\tthis.handleOpenBluetoothAdapter();\r\n\t\t\t\t \r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\r\n\t\t\tlet users = uni.getStorageSync('usersInfo');\r\n\t\t\tif (users) {\r\n\t\t\t\tthis.getUserInfo = JSON.parse(users);\r\n\t\t\t\tif (this.getUserInfo.data && this.getUserInfo.data.userinfo) {\r\n\t\t\t\t\tthis.getUserInfoDataToken = this.getUserInfo.data.userinfo ? true : false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\n\t\t\t \n\t\t\t \r\n\t\t\t// 999999999999\n\t\t\topenAuthSetting() {\n\t\t\t\tlet that = this;\n\t\t\t\tuni.getSetting({\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tconsole.log(res, JSON.stringify(res, \"getSetting\"));\n\t\t\t\t\t\tif (res.authSetting[\"scope.userLocation\"] != undefined && res.authSetting[\n\t\t\t\t\t\t\t\t\"scope.userLocation\"] != true) {\n\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\ttitle: \"请求授权当前位置\",\n\t\t\t\t\t\t\t\tcontent: \"需要获取您的地理位置，请确认授权\",\n\t\t\t\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\t\t\t\tif (res.cancel) {\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\ttitle: \"拒绝授权\",\n\t\t\t\t\t\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else if (res.confirm) {\n\t\t\t\t\t\t\t\t\t\tuni.openSetting({\n\t\t\t\t\t\t\t\t\t\t\tsuccess: function(dataAu) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(dataAu, \"openSetting\");\n\t\t\t\t\t\t\t\t\t\t\t\tif (dataAu.authSetting[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"scope.userLocation\"] == true) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"授权成功\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t//再次授权，调用wx.getLocation的API\n\t\t\t\t\t\t\t\t\t\t\t\t\tthat.getLocation();\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"授权失败\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (res.authSetting[\"scope.userLocation\"] == undefined) {\n\t\t\t\t\t\t\t//调用wx.getLocation的APIconsole.log(\"首次授权\");\n\t\t\t\t\t\t\tthis.getLocation();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//调用wx.getLocation的API\n\t\t\t\t\t\t\tthis.getLocation();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcomplete() {\n\t\t\t\t\t\tconsole.log(\"getSetting\");\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\r\n\t\t\t // 999999999\r\n\t\t\t\t\t\t\t\thandleLanya() {\r\n\t\t\t\t\t\t\t\t\t\tconst that = this\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t\t\tvar QQMapWX = require('../../utils/qqmap-wx-jssdk.js')\r\n\t\t\t\t\t\t\t\t\t\tvar qqmapsdk = new QQMapWX({\r\n\t\t\t\t\t\t\t\t\t\t\tkey: 'OB7BZ-S6FWT-GOBXR-LONYL-GKEE5-OTBRD' // 必填\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\twx.getLocation({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'wgs84',\r\n\t\t\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('纬度-------->', res)\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.latitude = res.latitude\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.longitude = res.longitude\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\twx.setStorageSync('latitude', res.latitude)\r\n\t\t\t\t\t\t\t\t\t\t\t\twx.setStorageSync('longitude', res.longitude)\r\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tfail(err) {\n\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"授权未通过\",\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: \"none\",\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\tthat.openAuthSetting();\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 坐标转换\r\n\t\t\t\t\t\t\t\t\t\t\t\tqqmapsdk.reverseGeocoder({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlocation: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlatitude: wx.getStorageSync('latitude'),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlongitude: wx.getStorageSync('longitude')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthat.address = res.result.address\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthat.address_component = res.result\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.address_component;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"11\", res.result)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthat.loginfn()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twx.setStorageSync('address_component', res\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.result.address_component\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.city)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfail: function(error) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error('错误了', error)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t// 用户授权登录\r\n\t\t\t\t\t\t\t\t\t//首先点击登录按钮的时候获取一下code，保存到data里\r\n\t\t\t\t\t\t\t\t\tloginfn() {\r\n\t\t\t\t\t\t\t\t\t\tlet that = this;\r\n\t\t\t\t\t\t\t\t\t\twx.login({\r\n\t\t\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.getawardDetail(res.code)\r\n\t\t\t\t\t\t\t\t\t\t\t\t// that.code = res.code;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t//调用button自带的弹窗获取用户信息方法\r\n\t\t\t\t\t\t\t\t\tasync onGetPhoneNumber(val) {\r\n\t\t\t\t\t\t\t\t\t\t\t//此时的val是用户点击了允许还是拒绝\r\n\t\t\t\t\t\t\t\t\t\t\tlet that = this;\r\n\t\t\t\t\t\t\t\t\t\t\tif (val.detail.errMsg === \"getPhoneNumber:ok\") {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//保存需要的** iv, encryptedData **\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tiv,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tencryptedData\r\n\t\t\t\t\t\t\t\t\t\t\t\t} = val.detail;\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tasync getawardDetail(code) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet that = this;\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait uni.request({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\turl: 'https://ys.shningmi.com/api/login/login',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: { //参数\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json' //自定义请求头信息\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmethod: 'POST', //请求方式，必须为大写\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} = res;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.setStorageSync('usersInfo', JSON.stringify(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.getUserInfo = JSON.parse(uni.getStorageSync(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'usersInfo'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('缓存数据--2----', this.getUserInfo.data\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.userinfo);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (this.getUserInfo.data && this.getUserInfo.data\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.userinfo) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('缓存数据--2----', this.getUserInfo\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.data.userinfo);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.getUserInfoDataToken = this.getUserInfo\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.data.userinfo ? true : false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t//0000000000000000000000000\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t// 手动连接蓝牙\r\n\t\t\t\t\t\t\t\t\t\t\thandleOpenBluetoothAdapter() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (this.openLanYa) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '请打开手机蓝牙'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"66666666666\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// return\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"888888888888\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.openLanYa = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclearInterval(this.timer)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.openBluetoothAdapter({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => { //已打开\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.getBluetoothAdapterState({ //蓝牙的匹配状态\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res1) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.openLanYa = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclearInterval(this.timer)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res1, '本机设备的蓝牙已打开')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 开始搜索蓝牙设备\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.startBluetoothDeviceDiscovery()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfail(error) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tduration: this\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.duration,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '查看手机蓝牙是否打开'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfail: err => { //未打开 \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// uni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \tduration: 10000,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \ttitle: '查看手机蓝牙是否打开'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t// 开始搜索蓝牙设备\r\n\t\t\t\t\t\t\t\t\t\t\tstartBluetoothDeviceDiscovery() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.startBluetoothDevicesDiscovery({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'startBluetoothDevicesDiscovery success',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 发现外围设备\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.onBluetoothDeviceFound()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfail: err => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(err, '错误信息')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t// 发现外围设备\r\n\t\t\t\t\t\t\t\t\t\t\tonBluetoothDeviceFound() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.onBluetoothDeviceFound((res) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (this.list.indexOf(res.devices[0].deviceId) == -1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (res.devices[0].name.slice(0, 4) === 'WMD8') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.createBLEConnection(res.devices[0].deviceId)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.list.push({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: res.devices[0].name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeviceId: res.devices[0].deviceId\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log('----this.list------', this.list)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t//获取在蓝牙模块生效期间所有已发现的蓝牙设备。包括已经和本机处于连接状态的设备。\r\n\t\t\t\t\t\t\t\t\t\t\tgetBluetoothDevices() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"获取蓝牙设备\");\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.getBluetoothDevices({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('获取蓝牙设备成功:');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res.devices);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t//选择设备连接吧deviceId传进来\r\n\t\t\t\t\t\t\t\t\t\t\tcreateBLEConnection(deviceId) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet _this = this;\r\n\t\t\t\t\t\t\t\t\t\t\t\t//data里面建立一个deviceId，存储起来\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.deviceId = deviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//连接蓝牙\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.createBLEConnection({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeviceId: this.deviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"蓝牙连接成功\", res);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 获取蓝牙服务\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t_this.getBLEDeviceServices()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"蓝牙连接失败\", res)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t// 停止搜寻蓝牙设备\r\n\t\t\t\t\t\t\t\t\t\t\tstopBluetoothDevicesDiscovery() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.stopBluetoothDevicesDiscovery({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('停止搜索蓝牙设备:' + e.errMsg);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfail: e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('停止搜索蓝牙设备失败，错误码：' + e.errCode);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//获取蓝牙特征\r\n\t\t\t\t\t\t\t\t\t\t\tgetBLEDeviceCharacteristics() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet _this = this;\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"进入特征\");\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.getBLEDeviceCharacteristics({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeviceId: this.deviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 这里的 serviceId 需要在 getBLEDeviceServices 接口中获取\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tserviceId: this.serviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'特征getBLEDeviceCharacteristics',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.characteristics = res\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.characteristics\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('特征数组', this\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.characteristics)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \"0000FFE1-0000-1000-8000-00805F9B34FB\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres.characteristics.forEach((item) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (item.uuid.indexOf(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"FFE1\") != -1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t_this\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.characteristicId =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titem.uuid\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//console.log('characteristicId:', item.uuid)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//利用传参的形势传给下面的notify，这里的uuid如果都需要用到，就不用做判断了，建议使用setTimeout进行间隔性的调用此方法\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t_this\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.notifyBLECharacteristicValueChange(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titem.uuid)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t// 启用 notify 功能\r\n\t\t\t\t\t\t\t\t\t\t\tnotifyBLECharacteristicValueChange(characteristicId) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet _this = this;\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(characteristicId, 'characteristicId')\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.notifyBLECharacteristicValueChange({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstate: true, // 启用 notify 功能\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdeviceId: this.deviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// 这里的 serviceId 需要在 getBLEDeviceServices 接口中获取\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tserviceId: this.serviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// 这里的 characteristicId 需要在 getBLEDeviceCharacteristics 接口中获取\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcharacteristicId: characteristicId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(this.characteristicId)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t_this.listenValueChange()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'notifyBLECharacteristicValueChange success',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres.errMsg)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'notifyBLECharacteristicValueChange fail',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres.errMsg)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t//获取蓝牙的所有服务\r\n\t\t\t\t\t\t\t\t\t\t\tgetBLEDeviceServices() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.getBLEDeviceServices({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeviceId: this.deviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('获取到蓝牙所有的服务:', res)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 0: {uuid: \"0000FFE0-0000-1000-8000-00805F9B34FB\", isPrimary: true}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 1: {uuid: \"00001800-0000-1000-8000-00805F9B34FB\", isPrimary: true}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 2: {uuid: \"00001801-0000-1000-8000-00805F9B34FB\", isPrimary: true}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres.services.forEach((item) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (item.uuid.indexOf(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"FFE0\") != -1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.serviceId = item\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.uuid;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"1800特征值\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.serviceId)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//获取特征\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.getBLEDeviceCharacteristics()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tstrToHexCharCode(str) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (str === \"\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn \"\";\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar hexCharCode = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\thexCharCode.push(\"0x\");\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < str.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\thexCharCode.push((str.charCodeAt(i)).toString(16));\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn hexCharCode.join(\"\");\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\thandleInToPay() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet params = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdeviceId: this.deviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tserviceId: this.serviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tunids: this.list[0].name.slice(4),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcharacteristicId: this.characteristicId\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet param = JSON.stringify(params)\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\turl: '/pages/game/detail?param=' + param\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t//写入蓝牙 这页面传入PCSS是唤醒功能\r\n\t\t\t\t\t\t\t\t\t\t\tasync writeBLECharacteristicValue(v) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('这页面传入PCSS是唤醒功能', v);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('这页面传入PCSS是唤醒功能1', this.deviceId);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('这页面传入PCSS是唤醒功能2', this.serviceId);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('这页面传入PCSS是唤醒功能3', this.characteristicId);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet unids = this.list[0].name.slice(4)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//PASS PBSS\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet msg = v + unids;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst buffer = new ArrayBuffer(msg.length);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst dataView = new DataView(buffer);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < msg.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataView.setUint8(i, msg.charAt(i).charCodeAt())\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet resHex = this.ab2hex(buffer) + \"0D0A\";\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar buffers = new Uint8Array(resHex.match(/[\\da-f]{2}/gi).map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfunction(h) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn parseInt(h, 16)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})).buffer\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('这页面传入PCSS是唤醒功能3buffers', buffers);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.writeBLECharacteristicValue({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeviceId: this.deviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tserviceId: this.serviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcharacteristicId: this.characteristicId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: buffers,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('写入成功', res);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"开启成功\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('写入失败1', JSON.stringify(res))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log('写入失败2', JSON.stringify(buffer))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 88888888888\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//字符串转arraybuffer\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tstring2buffer(str) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// 首先将字符串转为16进制\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet val = \"\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < str.length; i++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (val === '') {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tval = str.charCodeAt(i).toString(16)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tval += ',' + str.charCodeAt(i).toString(16)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('16数据', val)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(val)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// 将16进制转化为ArrayBuffer\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn new Uint8Array(val.match(/[\\da-f]{2}/gi).map(function(h) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn parseInt(h, 16)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})).buffer\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\tstr2ab(str) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst buffer = new ArrayBuffer(str.length / 2);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet x = new Uint8Array(buffer);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < x.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tx[i] = parseInt(str.substr(2 * i, 2), 16)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn buffer;\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t// ArrayBuffer转16进度字符串示例\r\n\t\t\t\t\t\t\t\t\t\t\t\tab2hex(buffer) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst hexArr = Array.prototype.map.call(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnew Uint8Array(buffer),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfunction(bit) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (bit.toString(16)).slice(-2)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn hexArr.join('')\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 将16进制的内容转成我们看得懂的字符串内容\r\n\t\t\t\t\t\t\t\t\t\t\t\thexCharCodeToStr(hexCharCodeStr) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar trimedStr = hexCharCodeStr.trim();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar rawStr = trimedStr.substr(0, 2).toLowerCase() === \"0x\" ?\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrimedStr.substr(2) : trimedStr;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar len = rawStr.length;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (len % 2 !== 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talert(\"存在非法字符!\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn \"\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar curCharCode;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar resultStr = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < len; i = i + 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurCharCode = parseInt(rawStr.substr(i, 2), 16);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tresultStr.push(String.fromCharCode(curCharCode));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn resultStr.join(\"\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 【9】监听消息变化\r\n\t\t\t\t\t\t\t\t\t\t\t\tlistenValueChange() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet _this = this;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"进去了吗\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t_this.showButton = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.onBLECharacteristicValueChange(res => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 结果\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('进去了吗1111', res)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 结果里有个value值，该值为 ArrayBuffer 类型，所以在控制台无法用肉眼观察到，必须将该值转换为16进制\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet resHex = _this.ab2hex(res.value)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(resHex)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 最后将16进制转换为ascii码，就能看到对应的结果\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet result = _this.hexCharCodeToStr(resHex)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('最终结果', result)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 支付时判断蓝牙是不是连接的\r\n\t\t\t\t\t\t\t\t\t\t\t\topenBluetoothAdapterPay() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet that = this;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.openBluetoothAdapter({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 开启支付，为了测试先注释掉\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthat.createorder('PBSS', 1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('7777777')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfail: (res) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthat.showButton = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: '请开启蓝牙后，重新扫码'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (res.errCode === 10001) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 去调用蓝牙自动连接\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// that.openLanYa=true;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"---------------\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// that.onBluetoothDeviceFound()\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 清空蓝牙，重新搜索\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// that.list=[]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// that.startBluetoothDeviceDiscovery()\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//监听蓝牙适配器是否打开，若打开则自动搜索蓝牙设备\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//                  uni.onBluetoothAdapterStateChange(function(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//                      if (res.available) { \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \t// that.list=[]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \t// that.startBluetoothDeviceDiscovery()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \t// that.createorder('PBSS',1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \tconsole.log('999999') \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//                          // that.startBluetoothDevicesDiscovery();//开启蓝牙设备搜索\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//                      } else{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// \tconsole.log('88888888')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//                  });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 创建订单\r\n\t\t\t\t\t\t\t\t\t\t\t\tcreateorder(v, numV) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet _this = this;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// _this.writeBLECharacteristicValue(v);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log('-------->',_this.getUserInfo);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\turl: 'https://ys.shningmi.com/api/order/create',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tguid: \"guid\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tqty: numV,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taddress: _this.address,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlatitude: _this.latitude,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlongitude: _this.longitude\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': _this.getUserInfo.data.token\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// if (res.code == 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.requestPayment({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprovider: 'wxpay', // 服务提提供商\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttimeStamp: res.data.data\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.timeStamp, // 时间戳\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnonceStr: res.data.data\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.nonceStr, // 随机字符串\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpackage: res.data.data.package,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsignType: res.data.data\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.signType, // 签名算法\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpaySign: res.data.data.sign, // 签名\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('支付成功', res);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t_this\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.writeBLECharacteristicValue(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv)\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('支付失败', err);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 8888888888\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 获取当前位置\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 当前位置\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.backgroundColorLine {\r\n\t\tbackground: linear-gradient(180deg, #4E85FD 0%, #84BBFF 100%);\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\r\n\t.lanyastyle {\r\n\t\twidth: 500upx;\r\n\t\theight: 500upx;\r\n\t\tmargin: 0 auto;\r\n\t\tdisplay: flex;\r\n\t\tpadding-top: 24%;\r\n\t}\r\n\r\n\t.backgroundColorLineText {\r\n\t\tcolor: #fff;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 14px;\r\n\t\tmargin-top: 50upx;\r\n\t}\r\n\r\n\t.backgroundColorLineSuccess {\r\n\t\tcolor: #fff;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 14px;\r\n\t\tmargin-top: 50upx;\r\n\t}\r\n\r\n\t.writeStyle {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-around;\r\n\t\tmargin-top: 50px;\r\n\t}\r\n\r\n\t.bgColor {\r\n\t\twidth: 60%;\r\n\t\tbackground-color: #fff;\r\n\t\tborder: none;\r\n\t\toutline: none;\r\n\t\tcolor: #e4393c;\r\n\t\tfont-size: 26upx;\r\n\t}\r\n\r\n\t.writeStyle12 {\r\n\t\tfont-size: 30upx;\r\n\t\twidth: 200upx;\r\n\t\theight: 100upx;\r\n\t\tline-height: 100upx;\r\n\t}\r\n\r\n\t.huanxing {\r\n\t\tposition: fixed;\r\n\t\tright: 30upx;\r\n\t\tbottom: 50upx;\r\n\t\t/* width: 100upx; */\r\n\t\t/* height: 100upx; */\r\n\t\t/* line-height: 100upx; */\r\n\t\ttext-align: center;\r\n\t\tborder-radius: 50upx;\r\n\t\tbackground-color: #fff;\r\n\t\tcolor: #4E85FD;\r\n\t\tfont-size: 12px;\r\n\t\tpadding: 10px;\r\n\t}\r\n\r\n\t.getLocation {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\talign-items: center;\r\n\t\tfont-size: 15px;\r\n\t\tcolor: #fff;\r\n\t\tpadding-left: 20upx;\r\n\t}\r\n\r\n\t.getLocation- {\r\n\t\twidth: 30upx;\r\n\t\theight: 30upx;\r\n\t\tmargin-right: 10upx;\r\n\t}\r\n</style>","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=57280228&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=57280228&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1686562518561\n      var cssReload = require(\"E:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}